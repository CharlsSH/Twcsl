<!--

  begin store category section reveal
  
  License       : < https://bit.ly/3F8sn8W >
  
  Version       : 0.2.0
  
  SS Version    : 7.1
  
  Fluid
  Engine
  Compatible    : Yes
  
  Dependencies  : twcsl
  
  Note          : the code is comprised of a style and script tag. both are
                  needed for the full effect to work
                  
                  this effect is not active in SS Preview to test it use
                  private browsing < https://bit.ly/3f6lhq2 >.
  
  By            : Thomas Creedon < http://www.tomsWeb.consulting/ >
  
  no user serviceable parts below
  
  -->
  
  <style>
  
      html:not( .squarespace-damask ) #page .page-section:not( .collection-type-products ) {
      
        display : none;
        
        }
        
      </style>
      
  <script>
  
    $( ( ) => {
    
      if ( window.frameElement !== null ) return; // bail if in preview
      
      const paddingTop = twcsl.getPageSectionNth ( )
      
        .css ( 'padding-top' );
        
      let categories = twcsl.page.store.list.categories;
      
      categories = categories &&
      
        $( `x-twc-scsr[data-categories="${ categories }"]` ).length ?
        
        categories : 'default';
        
      // remove unused sections
      
      $( 'x-twc-scsr[data-categories]' )
      
        .filter ( `x-twc-scsr[data-categories!="${ categories }"]` )
        
        .parents ( '.page-section' )
        
        .remove ( );
        
      twcsl.getPageSectionNth ( )
      
        .css ( 'padding-top', paddingTop );
        
      // show the remaining sections
      
      $( '#page .page-section:not( .collection-type-products )' )
      
        .css ( 'display', 'flex' );
        
      } );
      
    </script>
    
  <!-- end store category section reveal -->
